<html>
<head>
	<title>Camera App</title>
</head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
	<META HTTP-Equiv="MinimizeButton" content="visibility:Visible;top:30 " >
	<META HTTP-Equiv="quitbutton" Content="visibility:visible;left:10;top:30">
	<META HTTP-Equiv="ReloadButton" Content="visibility:visible">

	<script type="text/javascript" charset="utf-8" src="/public/jquery/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="/public/jquery/jquery.json-2.3.min.js"></script>

	<!--script type="text/javascript" charset="utf-8" src="/public/api/rhoapi.js"></script-->
	<!--script type="text/javascript" charset="utf-8" src="/public/api/rho.camera.js"></script-->
	<script type="text/javascript" src="/public/api/rhoapi-modules.js"></script>
<body>
<p></p>
<p><strong>Camera App</strong></p>
<button onclick="enumFunc();">Enumerate Cameras</button><br><br>
<div id='enumdata'></div><p></p>

<span class="heading">
	Select the Camera: &nbsp;&nbsp;<select name="cameradropdown" id="cameradropdown" onChange="selectCamera()">
		<option value="" selected>--Select Camera--</option>
		<option value={}></option>
		<option value={}></option>
	</select>
</span>

<button onclick="takepic();">takePicture</button><br><br>
<div id='cbdata'></div><br><br>
<img src='' id='camImage'></img><br>
<button onclick="send();">Send</button><br><br> (send to server if captured image is good !)
<div id='uploadstatus'></div><br><br>
</body>

<script type="text/javascript">
var data = "";
var enumData;
var cameraObj;
var cameratype;
var imageuricb;
var status;
var srvURL = 'http://10.233.85.82:8081';
var enumFunc = function() {
	var enumData = Rho.Camera.enumerate();
	for (var i = 0; i <= enumData.length - 1; i++) {
		data += (i+1).toString() + ") " + enumData[i].getProperty('ID') + ' ' + enumData[i].getProperty('cameraType') +  "; ";
	};
	
	document.getElementById("enumdata").innerHTML = data;

	if (enumData.length > 0){
		for (i=0; i < enumData.length; i++){
	       	document.getElementById('cameradropdown').options[i + 1].text = enumData[i].getProperty('ID') + ' ' + enumData[i].getProperty('cameraType');
		   	document.getElementById('cameradropdown').options[i + 1].value = enumData[i].getProperty('cameraType');
		}
	}else{
		alert("cameras not available in this device");
	}
}
var selectCamera = function () {
	var w = document.getElementById('cameradropdown').selectedIndex;
    cameratype = document.getElementById('cameradropdown').options[w].value;
}
var	takepic = function(){
	cameraObj = Rho.Camera.getCameraByType(cameratype);
	cameraObj.takePicture({'outputFormat' : 'image'},cbfunc);
}
function cbfunc (cbData) {
	data = "status : " + cbData.status;
	data += "; message : " + cbData.message;
	data += "; imageHeight : " + cbData.imageHeight;
	data += "; imageWidth : " + cbData.imageWidth;
	data += "; imageFormat : " + cbData.imageFormat;
	data += "; imageUri : " + cbData.imageUri;

	document.getElementById("cbdata").innerHTML = data;
	document.getElementById('camImage').src = cbData.imageUri;
	imageuricb = cbData.imageUri;
}
var upload_file_callback = function (args){
	status = "File upload status : " + args['status'];
	data = args['body'];
	document.getElementById("uploadstatus").innerHTML = status;
}
var send = function(){
	var uploadfileProps = {
		url: srvURL,
		filename: imageuricb,
		body: "uploading file",
		fileContentType: "text/plain"
	};
	Rho.Network.uploadFile(uploadfileProps,upload_file_callback);
};
</script>

</html>